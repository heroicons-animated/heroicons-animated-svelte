<script lang="ts">
let { size = 28, class: className = "" } = $props();

let isAnimating = $state(false);
let isControlled = $state(false);

export function startAnimation() {
  if (!isControlled) {
    isAnimating = true;
    setTimeout(() => {
      isAnimating = false;
    }, 600);
  }
}

export function stopAnimation() {
  isAnimating = false;
}

export function setControlled(value: boolean) {
  isControlled = value;
}

function handleMouseEnter() {
  if (!isControlled) startAnimation();
}

function handleMouseLeave() {
  if (!isControlled) stopAnimation();
}
</script>

<div
  class={className}
  onmouseenter={handleMouseEnter}
  onmouseleave={handleMouseLeave}
  role="img"
>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width={size}
    height={size}
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
    stroke-linejoin="round"
    class="icon-svg"
  >
    <path
      d="M15 6.75C15 8.40685 13.6569 9.75 12 9.75C10.3431 9.75 9 8.40685 9 6.75C9 5.09315 10.3431 3.75 12 3.75C13.6569 3.75 15 5.09315 15 6.75Z"
    />
    <path
      d="M17.9999 18.7191C18 18.7294 18 18.7397 18 18.75C18 18.975 17.9876 19.1971 17.9635 19.4156C16.2067 20.4237 14.1707 21 12 21C9.82933 21 7.79327 20.4237 6.03651 19.4156C6.01238 19.1971 6 18.975 6 18.75C6 18.7397 6.00003 18.7295 6.00008 18.7192M17.9999 18.7191C17.994 17.5426 17.6494 16.4461 17.0587 15.5222M17.0587 15.5222C15.9928 13.8552 14.1255 12.75 12 12.75C9.87479 12.75 8.00765 13.8549 6.94169 15.5216M6.94169 15.5216C6.35071 16.4457 6.00598 17.5424 6.00008 18.7192"
    />
    <path
      class="usergroup-right"
      class:usergroup-slide={isAnimating}
      d="M21 9.75C21 10.9926 19.9926 12 18.75 12C17.5074 12 16.5 10.9926 16.5 9.75C16.5 8.50736 17.5074 7.5 18.75 7.5C19.9926 7.5 21 8.50736 21 9.75ZM17.9999 18.7191C18.2474 18.7396 18.4978 18.75 18.7506 18.75C19.7989 18.75 20.8054 18.5708 21.741 18.2413C21.7473 18.1617 21.7506 18.0812 21.7506 18C21.7506 16.3431 20.4074 15 18.7506 15C18.123 15 17.5403 15.1927 17.0587 15.5222"
    />
    <path
      class="usergroup-left"
      class:usergroup-slide={isAnimating}
      d="M7.5 9.75C7.5 10.9926 6.49264 12 5.25 12C4.00736 12 3 10.9926 3 9.75C3 8.50736 4.00736 7.5 5.25 7.5C6.49264 7.5 7.5 8.50736 7.5 9.75ZM6.00008 18.7192C5.75299 18.7396 5.50307 18.75 5.25073 18.75C4.2024 18.75 3.19593 18.5708 2.26029 18.2413C2.25396 18.1617 2.25073 18.0812 2.25073 18C2.25073 16.3431 3.59388 15 5.25073 15C5.87796 15 6.46023 15.1925 6.94169 15.5216"
    />
  </svg>
</div>

<style>
div {
  display: inline-block;
}

.icon-svg {
  transform-box: fill-box;
  transform-origin: center;
}

.usergroup-right {
  transform: translateX(0);
  opacity: 1;
}

.usergroup-right.usergroup-slide {
  animation: usergroup-right-slide 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s
    forwards;
}

.usergroup-left {
  transform: translateX(0);
  opacity: 1;
}

.usergroup-left.usergroup-slide {
  animation: usergroup-left-slide 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s
    forwards;
}

@keyframes usergroup-right-slide {
  0% {
    transform: translateX(-6px);
    opacity: 0;
  }
  30% {
    opacity: 0;
  }
  100% {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes usergroup-left-slide {
  0% {
    transform: translateX(6px);
    opacity: 0;
  }
  30% {
    opacity: 0;
  }
  100% {
    transform: translateX(0);
    opacity: 1;
  }
}
</style>
